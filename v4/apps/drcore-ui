captainVersion: 4
services:
    $$cap_appname:
        image: zakesoft/drcore:$$cap_drcore_version
        volumes:
            - $$cap_appname-data:/usr/src/app/src/assets/data
            - $$cap_appname-uploads:/usr/src/app/public/uploads
        restart: always
        environment:
            NODE_ENV: production
            PORT: 3001
            HOST: 0.0.0.0
            INSTANCE_NAME: $$cap_fabrika_adi
            INTERNAL_API_BASE_URL: $$cap_api_url
            FRONTEND_ORIGIN: '*'
            NEXBUS_FETCH_TIMEOUT_MS: $$cap_nexbus_timeout
            UPLOAD_PROVIDER: $$cap_upload_provider
        caproverExtra:
            containerHttpPort: '3001'
caproverOneClickApp:
    variables:
        - id: $$cap_drcore_version
          label: DR Core Versiyon
          defaultValue: 'latest'
          description: Docker Hub image versiyonu (latest veya 1.10.7 gibi)
          validRegex: /^([^\s^\/])+$/
        - id: $$cap_fabrika_adi
          label: Fabrika AdÄ±
          defaultValue: ''
          description: >-
              Fabrika kÄ±sa adÄ± (kÃ¼Ã§Ã¼k harf, Ã¶rn: escon, akgida, hamidiye).
              Bu ad INSTANCE_NAME ve CDN klasÃ¶rÃ¼ olarak kullanÄ±lÄ±r.
          validRegex: /^[a-z0-9-]+$/
        - id: $$cap_api_url
          label: NexBus API URL
          defaultValue: 'http://172.17.0.1:5000/api'
          description: Bu fabrikaya ait NexBus API adresi. Her fabrika iÃ§in FARKLI port/adres olmalÄ±.
        - id: $$cap_nexbus_timeout
          label: NexBus Timeout (ms)
          defaultValue: '8000'
          description: NexBus API istek zaman aÅŸÄ±mÄ± (milisaniye)
        - id: $$cap_upload_provider
          label: Upload Provider
          defaultValue: 'cdn'
          description: >-
              GÃ¶rsel yÃ¼kleme yÃ¶ntemi: cdn (Datacenter CDN) veya local (container iÃ§i).
              CDN Ã¶nerilir.
          validRegex: /^(cdn|local)$/
    instructions:
        start: >-
            DR Core UI - EndÃ¼striyel SCADA Dashboard ve Veri GÃ¶rselleÅŸtirme sistemi.


            ğŸ“‹ Kurulum adÄ±mlarÄ±:

            1. Fabrika adÄ±nÄ± girin (kÃ¼Ã§Ã¼k harf, boÅŸluksuz, Ã¶rn: escon)

            2. NexBus API URL'sini bu fabrikanÄ±n NexBus adresine ayarlayÄ±n

            3. Deploy edin

            4. Admin panelinden GitHub config yÃ¼klemesi yapÄ±n (Ayarlar > Config YÃ¼kle)


            âœ… Persistent volume'lar otomatik oluÅŸturulur - restart'ta veri kaybolmaz.
        end: >-
            âœ… DR Core UI baÅŸarÄ±yla kuruldu!


            ğŸŒ Uygulama adresi: http://$$cap_appname.$$cap_root_domain


            ğŸ“Œ Sonraki adÄ±m: Admin paneline gidin (Ayarlar sayfasÄ±) ve GitHub'dan
            fabrika config dosyasÄ±nÄ± yÃ¼kleyin. YÃ¼klemeden Ã¶nce sayfalar boÅŸ gÃ¶rÃ¼necektir.


            âš ï¸ INSTANCE_NAME: $$cap_fabrika_adi

            âš ï¸ Persistent Volume: $$cap_appname-data, $$cap_appname-uploads
    displayName: DR Core UI
    isOfficial: true
    description: DR Core UI - EndÃ¼striyel SCADA Dashboard ve Veri GÃ¶rselleÅŸtirme. Her fabrika iÃ§in ayrÄ± deploy edin.
    documentation: https://github.com/zakeGit/DR_CoreUI
